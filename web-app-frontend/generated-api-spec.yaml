openapi: 3.0.1
info:
  title: OpenAPI definition
  version: v0
servers:
- url: http://localhost:5000
  description: Generated server url
paths:
  /courses/{id}:
    get:
      tags:
      - course-controller
      operationId: getCourse
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
    put:
      tags:
      - course-controller
      operationId: editCourse
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCourseRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/Course'
      security:
      - JWT_AUTH: []
    delete:
      tags:
      - course-controller
      operationId: deleteCourse
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: OK
      security:
      - JWT_AUTH: []
  /activities/{activityId}/files:
    put:
      tags:
      - activity-controller
      operationId: ackPublicActivityFileUpload
      parameters:
      - name: activityId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UploadAccessDto'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ActivityDetailsDto'
      security:
      - JWT_AUTH: []
    post:
      tags:
      - activity-controller
      operationId: preparePublicActivityFileUpload
      parameters:
      - name: activityId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/InitFileUploadRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StorageAccessRequest'
      security:
      - JWT_AUTH: []
  /courses:
    get:
      tags:
      - course-controller
      operationId: getUserCourses
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
    post:
      tags:
      - course-controller
      operationId: addCourse
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateCourseRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
  /courses/{courseId}/students:
    post:
      tags:
      - course-controller
      operationId: addStudentToCourse
      parameters:
      - name: courseId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AddStudentRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
    delete:
      tags:
      - course-controller
      operationId: removeStudentFromCourse
      parameters:
      - name: courseId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
  /auth/login:
    post:
      tags:
      - auth-controller
      summary: Login user
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/AuthDetailsDto'
  /courses/join:
    patch:
      tags:
      - course-controller
      operationId: joinCourse
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JoinCourseRequest'
        required: true
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseDetailsDto'
      security:
      - JWT_AUTH: []
  /users/me:
    get:
      tags:
      - user-controller
      operationId: getUserInfo
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/UserDetailsDto'
      security:
      - JWT_AUTH: []
  /service-modules:
    get:
      tags:
      - service-module-controller
      operationId: getModuleList
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ServiceModuleDetailsDto'
      security:
      - JWT_AUTH: []
  /service-modules/{id}:
    get:
      tags:
      - service-module-controller
      operationId: getServiceModule
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/ServiceModuleDetailsDto'
      security:
      - JWT_AUTH: []
  /service-modules/config:
    get:
      tags:
      - service-module-controller
      operationId: getSupportedServices
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ServiceConfigDto'
      security:
      - JWT_AUTH: []
  /courses/{id}/activities:
    get:
      tags:
      - course-controller
      operationId: getCourseActivityList
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Activity'
      security:
      - JWT_AUTH: []
  /courses/summary/{uuid}:
    get:
      tags:
      - course-controller
      operationId: getPublicCourseData
      parameters:
      - name: uuid
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/CourseSummaryDto'
      security:
      - JWT_AUTH: []
  /activities/{activityId}/files/{fileId}:
    get:
      tags:
      - activity-controller
      operationId: getPublicActivityFileDownloadRequest
      parameters:
      - name: activityId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: fileId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        "200":
          description: OK
          content:
            '*/*':
              schema:
                $ref: '#/components/schemas/StorageAccessRequest'
      security:
      - JWT_AUTH: []
components:
  schemas:
    ActivityInstructionDto:
      required:
      - untrustedPossiblyDangerousHtml
      type: object
      properties:
        untrustedPossiblyDangerousHtml:
          type: string
    CreateActivityRequest:
      required:
      - description
      - endTime
      - instructionsFromTeacher
      - name
      - selectedModulesIds
      - startTime
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        startTime:
          type: string
          format: date-time
        endTime:
          type: string
          format: date-time
        instructionsFromTeacher:
          type: array
          items:
            $ref: '#/components/schemas/ActivityInstructionDto'
        selectedModulesIds:
          type: array
          items:
            type: integer
            format: int64
    CreateCourseRequest:
      required:
      - activities
      - description
      - expectedStudentCount
      - name
      - subject
      type: object
      properties:
        name:
          type: string
        subject:
          type: string
        description:
          type: string
        expectedStudentCount:
          type: integer
          format: int32
        activities:
          type: array
          items:
            $ref: '#/components/schemas/CreateActivityRequest'
        password:
          type: string
    Activity:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        description:
          type: string
        startTime:
          type: string
          format: date-time
        endTime:
          type: string
          format: date-time
        instructionsFromTeacher:
          type: array
          items:
            $ref: '#/components/schemas/ActivityInstruction'
        modules:
          type: array
          items:
            $ref: '#/components/schemas/ActivityModule'
        publicFiles:
          type: array
          items:
            $ref: '#/components/schemas/RemoteFile'
        course:
          type: integer
          format: int64
    ActivityInstruction:
      type: object
      properties:
        id:
          type: integer
          format: int64
        untrustedPossiblyDangerousHtml:
          type: string
    ActivityLink:
      type: object
      properties:
        id:
          type: integer
          format: int64
        url:
          type: string
        connectionInfo:
          type: string
    ActivityModule:
      type: object
      properties:
        id:
          type: integer
          format: int64
        module:
          $ref: '#/components/schemas/ServiceModule'
        activity:
          $ref: '#/components/schemas/Activity'
        instruction:
          type: string
        requestId:
          type: integer
          format: int64
        links:
          type: array
          items:
            $ref: '#/components/schemas/ActivityLink'
    Course:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        subject:
          type: string
        description:
          type: string
        joinUUID:
          type: string
        password:
          type: string
        creationTime:
          type: string
          format: date-time
        activities:
          type: array
          items:
            $ref: '#/components/schemas/Activity'
        students:
          type: array
          items:
            $ref: '#/components/schemas/UserCourseData'
        teacher:
          $ref: '#/components/schemas/User'
    RemoteFile:
      type: object
      properties:
        id:
          type: integer
          format: int64
        path:
          type: string
        sizeBytes:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
    Role:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
    ServiceModule:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        instructionsFromTechnicalTeacher:
          type: string
        creatorName:
          type: string
        subject:
          type: string
        scheduleType:
          type: string
          enum:
          - JUPYTER
          - DOCKER
        creationTime:
          type: string
          format: date-time
    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        surname:
          type: string
        email:
          type: string
        roles:
          type: array
          items:
            $ref: '#/components/schemas/Role'
    UserCourseData:
      type: object
      properties:
        id:
          $ref: '#/components/schemas/UserCourseId'
        user:
          $ref: '#/components/schemas/User'
        course:
          $ref: '#/components/schemas/Course'
        joinedAt:
          type: string
          format: date-time
    UserCourseId:
      type: object
      properties:
        userId:
          type: integer
          format: int64
        courseId:
          type: integer
          format: int64
    InitFileUploadRequest:
      required:
      - filename
      - sizeBytes
      type: object
      properties:
        filename:
          type: string
        sizeBytes:
          type: integer
          format: int64
    StorageAccessRequest:
      required:
      - filePath
      - httpHeaders
      - httpMethod
      - provider
      - signedUrl
      - validTo
      type: object
      properties:
        provider:
          type: string
          enum:
          - gcloud
        filePath:
          type: string
        signedUrl:
          type: string
        validTo:
          type: string
          format: date-time
        httpMethod:
          type: string
        httpHeaders:
          type: object
          additionalProperties:
            type: string
    UploadAccessDto:
      required:
      - initFileUploadRequest
      - storageAccessRequest
      type: object
      properties:
        initFileUploadRequest:
          $ref: '#/components/schemas/InitFileUploadRequest'
        storageAccessRequest:
          $ref: '#/components/schemas/StorageAccessRequest'
    ActivityDetailsDto:
      required:
      - activityModules
      - description
      - endTime
      - id
      - instructionsFromTeacher
      - name
      - publicFiles
      - startTime
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        description:
          type: string
        startTime:
          type: string
          format: date-time
        endTime:
          type: string
          format: date-time
        instructionsFromTeacher:
          type: array
          items:
            $ref: '#/components/schemas/ActivityInstructionDto'
        activityModules:
          type: array
          items:
            $ref: '#/components/schemas/ActivityModuleDetailsDto'
        publicFiles:
          type: array
          items:
            $ref: '#/components/schemas/FileDto'
    ActivityModuleDetailsDto:
      required:
      - connectionDetails
      - id
      - instruction
      - module
      type: object
      properties:
        id:
          type: integer
          format: int64
        module:
          $ref: '#/components/schemas/ServiceModuleDetailsDto'
        instruction:
          type: string
        connectionDetails:
          type: array
          items:
            $ref: '#/components/schemas/ServiceConnectionDetailsDto'
    FileDto:
      required:
      - createdAt
      - id
      - name
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        createdAt:
          type: string
          format: date-time
    ServiceConnectionDetailsDto:
      required:
      - connectionInstruction
      - serviceName
      type: object
      properties:
        serviceName:
          type: string
        connectionInstruction:
          type: string
        url:
          type: string
        connectionInfo:
          type: string
    ServiceModuleDetailsDto:
      required:
      - creationTime
      - creatorName
      - id
      - instructionsFromTechnicalTeacher
      - name
      - subject
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        instructionsFromTechnicalTeacher:
          type: string
        creatorName:
          type: string
        subject:
          type: string
        creationTime:
          type: string
          format: date-time
    CourseDetailsDto:
      required:
      - activities
      - description
      - id
      - joinUUID
      - lastActivityTime
      - name
      - students
      - subject
      - teacher
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        teacher:
          $ref: '#/components/schemas/UserDetailsDto'
        lastActivityTime:
          type: string
          format: date-time
        subject:
          type: string
        description:
          type: string
        students:
          type: array
          items:
            $ref: '#/components/schemas/ParticipantDetailsDto'
        activities:
          type: array
          items:
            $ref: '#/components/schemas/ActivityDetailsDto'
        joinUUID:
          type: string
        coursePassword:
          type: string
    ParticipantDetailsDto:
      required:
      - joinedAt
      - participant
      type: object
      properties:
        participant:
          $ref: '#/components/schemas/UserDetailsDto'
        joinedAt:
          type: string
          format: date-time
    UserDetailsDto:
      required:
      - email
      - name
      - surname
      type: object
      properties:
        name:
          type: string
        surname:
          type: string
        email:
          type: string
    AddStudentRequest:
      required:
      - email
      type: object
      properties:
        email:
          type: string
    LoginRequest:
      required:
      - email
      - password
      type: object
      properties:
        email:
          type: string
        password:
          type: string
    AuthDetailsDto:
      required:
      - accessToken
      - expiresIn
      - roles
      type: object
      properties:
        accessToken:
          type: string
        expiresIn:
          type: integer
          format: int64
        roles:
          type: array
          items:
            type: string
            enum:
            - STUDENT
            - TEACHER
            - TECHNICAL_TEACHER
            - ADMIN
    JoinCourseRequest:
      required:
      - joinUUID
      type: object
      properties:
        joinUUID:
          type: string
        password:
          type: string
    ParameterDescription:
      required:
      - name
      - required
      - type
      type: object
      properties:
        name:
          type: string
        required:
          type: boolean
        type:
          type: string
          enum:
          - FILE
          - TEXT
        translatedLabel:
          type: object
          additionalProperties:
            type: string
        clientValidationHelpers:
          type: object
          additionalProperties:
            type: object
    ServiceConfigDto:
      required:
      - parameterDescriptions
      - scheduleType
      - serviceName
      type: object
      properties:
        scheduleType:
          type: string
          enum:
          - JUPYTER
          - DOCKER
        serviceName:
          type: string
        parameterDescriptions:
          type: array
          items:
            $ref: '#/components/schemas/ParameterDescription'
    CourseSummaryDto:
      required:
      - isPasswordProtected
      - joinUUID
      - name
      type: object
      properties:
        name:
          type: string
        isPasswordProtected:
          type: boolean
        joinUUID:
          type: string
  securitySchemes:
    JWT_AUTH:
      type: http
      scheme: bearer
      bearerFormat: JWT
